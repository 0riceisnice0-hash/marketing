---
import type { Region } from '../config/site';

interface Props {
  currentRegion: Region;
}

const { currentRegion } = Astro.props;
const basePath = '/marketing';
const currentPath = Astro.url.pathname.replace(basePath, '').replace(/^\/uk|^\/us/, '');
---

<div class="flex items-center space-x-2">
  <span class="text-xs text-text-tertiary uppercase tracking-wider font-medium hidden sm:inline">Region</span>
  <div class="relative inline-flex items-center rounded-full bg-bg-elevated border border-border-subtle p-1" role="group">
    <a
      href={`${basePath}/uk${currentPath || ''}`}
      class:list={[
        'relative px-4 py-1.5 text-sm font-medium rounded-full transition-all flex items-center space-x-1.5',
        currentRegion === 'uk'
          ? 'bg-accent-primary text-white shadow-glow-primary z-10'
          : 'text-text-secondary hover:text-text-primary'
      ]}
      data-region="uk"
    >
      <span class="text-base">ðŸ‡¬ðŸ‡§</span>
      <span>UK</span>
    </a>
    <a
      href={`${basePath}/us${currentPath || ''}`}
      class:list={[
        'relative px-4 py-1.5 text-sm font-medium rounded-full transition-all flex items-center space-x-1.5',
        currentRegion === 'us'
          ? 'bg-accent-primary text-white shadow-glow-primary z-10'
          : 'text-text-secondary hover:text-text-primary'
      ]}
      data-region="us"
    >
      <span class="text-base">ðŸ‡ºðŸ‡¸</span>
      <span>US</span>
    </a>
  </div>
</div>

<script>
  // Store region preference when switching
  document.querySelectorAll('[data-region]').forEach((link) => {
    link.addEventListener('click', (e) => {
      const region = (e.currentTarget as HTMLElement).getAttribute('data-region');
      if (region) {
        localStorage.setItem('region', region);
      }
    });
  });
</script>

<style>
  /* Smooth slide animation for active state */
  @media (prefers-reduced-motion: no-preference) {
    [data-region] {
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }
  }
</style>
